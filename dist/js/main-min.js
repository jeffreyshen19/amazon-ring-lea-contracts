let margin={top:10,right:20,bottom:25,left:50},height=250-margin.top-margin.bottom,width=500-margin.left-margin.right;function drawTimeSeries(t){let e=d3.select("#time-series").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")"),a=d3.scaleTime().range([0,width]),n=d3.scaleLinear().range([height,0]);a.domain(d3.extent(t,function(t){return t.date})),n.domain([0,d3.max(t,function(t){return t.y})+20]);let r=d3.line().x(function(t){return a(t.date)}).y(function(t){return n(t.y)});e.append("path").data([t]).attr("class","line").attr("d",r);let i=d3.axisBottom(a).tickFormat(d3.timeFormat("%m/%Y")),o=d3.axisLeft(n);e.append("g").attr("transform","translate(0,"+height+")").call(i),e.append("g").call(o),e.append("text").attr("transform","rotate(-90)").attr("y",0-margin.left).attr("x",0-height/2).attr("dy","1em").style("text-anchor","middle").style("font-size","12px").style("font-family","IBM Plex Sans").text("Monthly Agency Contracts")}$.getJSON("http://127.0.0.1:3000/",function(t){console.log(t);let e={};t.agencies.forEach(function(t){t.activeDate=new Date(t.activeDate);let a=new Date(t.activeDate.getFullYear(),t.activeDate.getMonth());a in e||(e[a]=0),e[a]+=1}),e=Object.keys(e).map(function(t){return{date:new Date(t),y:e[t]}}).sort(function(t,e){return t.date-e.date}),console.log(e),drawTimeSeries(e)});