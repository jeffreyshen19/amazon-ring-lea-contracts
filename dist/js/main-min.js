function drawTimeSeries(t,e,i){let a=10,n=20,r=25,o=50,s=250-a-r,c=document.getElementById("time-series").offsetWidth-o-n,l=d3.select("#time-series").select("svg").attr("width",c+o+n).attr("height",s+a+r).select("g").attr("transform","translate("+o+","+a+")"),d=d3.scaleTime().range([0,c]),m=d3.scaleLinear().range([s,0]);d.domain(e),m.domain(i);let u=d3.line().x(function(t){return d(t.date)}).y(function(t){return m(t.y)});l.select(".line").data([t]).attr("d",u);let f=d3.axisBottom(d).tickFormat(d3.timeFormat("%m/%Y")).ticks(d3.timeMonth.every(6)),y=d3.axisLeft(m);l.select(".xAxis").attr("transform","translate(0,"+s+")").call(f),l.select(".yAxis").call(y),l.select(".yAxisLabel").attr("transform","rotate(-90)").attr("y",0-o).attr("x",0-s/2).attr("dy","1em");let h=d3.bisector(function(t){return t.date}).left,g=d3.select("circle"),v=d3.select(".tooltip"),x=d3.timeFormat("%B %Y");l.select("rect").attr("width",c).attr("height",s).on("mouseover",function(){g.attr("visibility","visible"),v.attr("visibility","visible")}).on("mouseout",function(){g.attr("visibility","hidden"),v.attr("visibility","hidden")}).on("mousemove",function(){let e=d.invert(d3.mouse(this)[0]),i=h(t,e,1),a=t[i-1],n=t[i],r=e-a.date>n.date-e?n:a;g.attr("cx",d(r.date)).attr("cy",m(r.y)),v.attr("x",d(r.date)+160>c?d(r.date)-170:d(r.date)+10).attr("y",m(r.y)-25).select(".box").html(`\n          <p class = "heading">${x(r.date)}</p>\n          <p>New Agencies: ${r.y}</p>\n        `),console.log(r)})}$.getJSON("http://127.0.0.1:3000/",function(t){console.log(t);let e={};t.agencies.forEach(function(t){t.activeDate=new Date(t.activeDate);let i=new Date(t.activeDate.getFullYear(),t.activeDate.getMonth());i in e||(e[i]=0),e[i]+=1}),e=Object.keys(e).map(function(t){return{date:new Date(t),y:e[t]}}).sort(function(t,e){return t.date-e.date});let i,a=d3.extent(e,function(t){return t.date}),n=[0,d3.max(e,function(t){return t.y})+20];drawTimeSeries(e,a,n),$(window).resize(function(){clearTimeout(i),i=setTimeout(function(){drawTimeSeries(e,a,n)},100)})});